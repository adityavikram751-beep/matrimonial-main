(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[432],{151:(e,t,a)=>{"use strict";a.d(t,{H:()=>s});let s="https://matrimonial-backend-7ahc.onrender.com"},483:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/analytics",function(){return a(5839)}])},5839:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>T});var s=a(7876),l=a(4232),r=a(2395),i=a.n(r),n=a(4352),o=a.n(n);let c="https://matrimonial-backend-7ahc.onrender.com",d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h={Sun:"Su",Mon:"Mo",Tue:"Tu",Wed:"We",Thu:"Th",Fri:"Fr",Sat:"Sa"};function x(){let[e,t]=(0,l.useState)([]),[a,r]=(0,l.useState)([]),[n,x]=(0,l.useState)([]);(0,l.useEffect)(()=>{(async()=>{let e=await fetch("".concat(c,"/admin/user-signup-trends")),a=await e.json();if(!a.success)return;let s={},l={};a.data.forEach(e=>{s[e.date]=Number(e.newUsers||0),l[e.date]=Number(e.returningUsers||0)});let i=d.map(e=>s[e]||0),n=d.map(e=>l[e]||0);t(i),r(n)})()},[]),(0,l.useEffect)(()=>{(async()=>{let e=await fetch("".concat(c,"/admin/search-to-match")),t=await e.json();t.success&&x(t.data)})()},[]);let f={chart:{type:"line",height:310,backgroundColor:"#ffffff",spacingLeft:10,spacingRight:10,spacingTop:15,spacingBottom:25},credits:{enabled:!1},title:{text:""},legend:{enabled:!1},xAxis:{categories:d.map(e=>h[e]),tickLength:0,labels:{style:{fontSize:"16px",fontWeight:600,color:"#4b5563"},y:20}},yAxis:{title:null,min:0,max:Math.max(...e,...a,5),tickPositions:[0,5,10,15,20,25,30],labels:{formatter(){return this.value},style:{fontSize:"15px",fontWeight:500,color:"#6b7280"}}},plotOptions:{series:{lineWidth:3,marker:{radius:6,fillColor:"#fff",lineWidth:3}}},tooltip:{shared:!0,backgroundColor:"#fff",borderRadius:10,borderWidth:1,style:{fontSize:"15px"}},series:[{name:"New Registered Users",data:e,color:"#facc15",marker:{lineColor:"#facc15"}},{name:"Returning Users",data:a,color:"#16a34a",marker:{lineColor:"#16a34a"}}]};return(0,s.jsxs)("div",{className:"mt-24 px-6 flex flex-col md:flex-row gap-10 w-full items-stretch",children:[(0,s.jsxs)("div",{className:"bg-white rounded-[32px] shadow-xl border border-gray-300 p-6 w-full md:w-[45%] h-full",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-10",children:"Search To Match"}),(0,s.jsx)("div",{className:"space-y-6",children:n.map((e,t)=>{var a;let l=(null==(a=n[0])?void 0:a.value)||1,r=e.value/l*100;return(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"w-[200px] text-[17px] font-semibold text-gray-800",children:e.stage}),(0,s.jsx)("div",{className:"w-[430px] mx-4",children:(0,s.jsx)("div",{className:"w-full h-[32px] bg-gray-200 rounded-full overflow-hidden",style:{boxShadow:"inset 0 2px 4px rgba(0,0,0,0.18), inset 0 -2px 4px rgba(255,255,255,0.4)"},children:(0,s.jsx)("div",{className:"h-full",style:{width:"".concat(r,"%"),background:"linear-gradient(90deg,#3A47FF,#001BFF)",borderRadius:18,filter:"drop-shadow(0 6px 14px rgba(0,0,0,0.35))"}})})}),(0,s.jsx)("div",{className:"w-[100px] text-right text-[18px] font-semibold text-gray-900",children:e.value})]},t)})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-[32px] shadow-xl border border-gray-300 p-10 w-full md:w-1/2 h-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-8 mb-6",children:[(0,s.jsx)("h2",{className:"text-[22px] font-semibold text-gray-900 whitespace-nowrap",children:"Running User Trend"}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-gray-700 text-[12px] font-semibold whitespace-nowrap",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{style:{width:8,height:4,background:"#facc15",borderRadius:4}}),(0,s.jsx)("span",{style:{width:10,height:10,borderRadius:"50%",border:"3px solid #facc15",background:"#fff"}}),(0,s.jsx)("span",{style:{width:8,height:4,background:"#facc15",borderRadius:4}}),(0,s.jsx)("span",{children:"New Registered Users"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{style:{width:8,height:4,background:"#16a34a",borderRadius:4}}),(0,s.jsx)("span",{style:{width:10,height:10,borderRadius:"50%",border:"3px solid #16a34a",background:"#fff"}}),(0,s.jsx)("span",{style:{width:8,height:4,background:"#16a34a",borderRadius:4}}),(0,s.jsx)("span",{children:"Returning Users"})]})]})]}),(0,s.jsx)(o(),{highcharts:i(),options:f})]})]})}var f=a(7814);let m=()=>{let[e,t]=(0,l.useState)([]),[a,r]=(0,l.useState)(0),[i,n]=(0,l.useState)(!1),o=(0,l.useRef)(null),c="https://matrimonial-backend-7ahc.onrender.com",d=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("".concat(c,"/admin/profile"),{headers:{Authorization:"Bearer ".concat(e)}}),a=await t.json();if(!a.success)return;let s=a.data;!0===s.notifications?(0,f.cH)(s._id):(0,f.G1)()}catch(e){console.log("Admin Pref Error:",e)}};(0,l.useEffect)(()=>{d()},[]);let h=async()=>{try{let e=localStorage.getItem("token"),a=await fetch("".concat(c,"/api/notification/me"),{headers:{Authorization:"Bearer ".concat(e)}}),s=await a.json();if(s.success){let e=s.data.reverse();t(e),r(e.filter(e=>!e.read).length)}}catch(e){console.log("Fetch Notification Error:",e)}};(0,l.useEffect)(()=>{h()},[]),(0,l.useEffect)(()=>{let e=(0,f.Ol)();if(e)return console.log("\uD83D\uDFE2 Socket Active For Analytics Page"),e.on("new-notification",e=>{t(t=>[e,...t]),r(e=>e+1)}),e.on("one-read",e=>{let{id:a}=e;t(e=>e.map(e=>e._id===a?{...e,read:!0}:e)),r(e=>Math.max(0,e-1))}),e.on("all-read",()=>{t(e=>e.map(e=>({...e,read:!0}))),r(0)}),e.on("delete-one",e=>{let{id:a}=e;t(e=>e.filter(e=>e._id!==a))}),e.on("delete-all",()=>{t([]),r(0)}),()=>{e.off("new-notification"),e.off("one-read"),e.off("all-read"),e.off("delete-one"),e.off("delete-all")}},[]),(0,l.useEffect)(()=>{let e=e=>{o.current&&!o.current.contains(e.target)&&n(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let x=async e=>{var a;let s=localStorage.getItem("token");t(t=>t.map(t=>t._id===e?{...t,read:!0}:t)),r(e=>Math.max(0,e-1)),await fetch("".concat(c,"/api/notification/mark-read/").concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(s)}}),null==(a=(0,f.Ol)())||a.emit("one-read",{id:e})},m=async()=>{var e;let a=localStorage.getItem("token");t(e=>e.map(e=>({...e,read:!0}))),r(0),await fetch("".concat(c,"/api/notification/mark-all"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a)}}),null==(e=(0,f.Ol)())||e.emit("all-read")},p=async e=>{var a;let s=localStorage.getItem("token");t(t=>t.filter(t=>t._id!==e)),await fetch("".concat(c,"/api/notification/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s)}}),null==(a=(0,f.Ol)())||a.emit("delete-one",{id:e})},u=async()=>{var e;let a=localStorage.getItem("token");t([]),r(0),await fetch("".concat(c,"/api/notification/delete-all"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}}),null==(e=(0,f.Ol)())||e.emit("delete-all")};return(0,s.jsxs)("div",{className:"bg-gray-100 px-10 py-4 shadow-sm border-b fixed top-0 z-50 flex items-center justify-between",style:{left:"250px",width:"calc(100% - 250px)"},children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Analytics"}),(0,s.jsx)("div",{className:"flex items-center gap-5",children:(0,s.jsxs)("div",{className:"relative",ref:o,children:[(0,s.jsxs)("div",{className:"cursor-pointer",onClick:()=>{let e=!i;n(e),e&&m()},children:[(0,s.jsx)("svg",{width:"30",height:"30",viewBox:"0 0 24 24",fill:"#FFC107",children:(0,s.jsx)("path",{d:"M12 24c1.104 0 2-.897 2-2h-4c0 1.103.896 2 2 2zm6.707-5l1.293 1.293V21H4v-1.707L5.293 19H6v-7c0-3.309 2.691-6 6-6s6 2.691 6 6v7h.707zM18 18H6v-7c0-2.757 2.243-5 5-5s5 2.243 5 5v7z"})}),a>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 h-3 w-3 bg-red-600 rounded-full"})]}),i&&(0,s.jsxs)("div",{className:"absolute right-0 mt-3 w-80 bg-white shadow-xl border rounded-lg max-h-96 overflow-y-auto p-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsx)("h3",{className:"font-semibold text-[16px]",children:"Notifications"}),(0,s.jsx)("button",{className:"text-blue-600 text-sm",onClick:m,children:"Mark all read"})]}),0===e.length?(0,s.jsx)("p",{className:"p-4 text-sm text-gray-500 text-center",children:"No notifications"}):e.map(e=>(0,s.jsxs)("div",{className:"border-b pb-3 mb-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("p",{className:"font-bold text-[15px] capitalize",children:e.title}),(0,s.jsx)("button",{onClick:()=>p(e._id),className:"text-red-600 text-xs",children:"Delete"})]}),(0,s.jsx)("p",{className:"text-gray-600 text-[13px] mt-1",children:e.message}),(0,s.jsx)("p",{className:"text-gray-500 text-[11px] mt-1",children:new Date(e.createdAt).toLocaleString()}),!e.read&&(0,s.jsx)("button",{className:"text-blue-600 text-xs mt-1",onClick:()=>x(e._id),children:"Mark as read"})]},e._id)),e.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("hr",{className:"border-gray-300 my-2"}),(0,s.jsx)("button",{className:"w-full py-2 text-red-600 font-semibold text-sm",onClick:u,children:"Delete All"})]})]})]})})]})};var p=a(8847),u=a.n(p),g=a(151);let b=u()(()=>Promise.resolve().then(a.t.bind(a,4352,23)),{loadableGenerated:{webpack:()=>[4352]},ssr:!1});function y(){let e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],[t,a]=(0,l.useState)([]),[r,n]=(0,l.useState)(Array(12).fill(0)),[o,c]=(0,l.useState)(Array(12).fill(0));(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch(g.H+"/admin/overview"),t=await e.json();if(!t.success)return;let s={Completed:"#0c7c1b",Low:"#f6931d",Incomplete:"#e21d1d",Moderate:"#f6c927"};a(["Completed","Low","Incomplete","Moderate"].map(e=>{let a=t.data.find(t=>t.name===e);return{name:e,y:a?a.value:0,color:s[e]}}))}catch(e){console.error(e)}})()},[]),(0,l.useEffect)(()=>{(async()=>{try{let t=await fetch(g.H+"/admin/matches-per-month"),a=await t.json();if(!a.success)return;n(e.map(e=>{var t;return(null==(t=a.data.find(t=>t.month===e))?void 0:t.totalUsers)||0})),c(e.map(e=>{var t;return(null==(t=a.data.find(t=>t.month===e))?void 0:t.matches)||0}))}catch(e){console.error(e)}})()},[]);let d={chart:{backgroundColor:"transparent",height:420},legend:{enabled:!1},title:{text:""},xAxis:{categories:e,labels:{style:{fontSize:14,fontWeight:600,color:"#444"}}},yAxis:{min:0,max:35,tickInterval:5,labels:{formatter(){return this.value+" M"},style:{fontWeight:600,color:"#666"}},title:{text:""}},series:[{type:"column",name:"Total no. of Users",borderRadius:22,color:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#fadb4d"],[1,"#d2a103"]]},data:r},{type:"line",name:"No. Of Matches",color:"#e22c2c",marker:{enabled:!0,fillColor:"#fff",radius:6,lineWidth:2.5,lineColor:"#e22c2c"},lineWidth:4,data:o}],credits:{enabled:!1}},h=e=>({width:18,height:18,background:"#fff",border:"3px solid ".concat(e),borderRadius:6,boxSizing:"border-box",display:"inline-block"});return(0,s.jsx)("div",{className:"w-full p-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white shadow-xl rounded-2xl p-6 relative",style:{border:"2px solid rgba(0,0,0,0.08)"},children:[(0,s.jsx)("h2",{style:{fontSize:26,fontWeight:700,color:"#222"},children:"Profile Overview"}),(0,s.jsxs)("div",{style:{position:"absolute",top:28,right:28,display:"flex",flexDirection:"column",gap:14,fontSize:16,fontWeight:600},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,s.jsx)("span",{style:h("#0c7c1b")}),"Completed"]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,s.jsx)("span",{style:h("#f6931d")}),"Low"]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,s.jsx)("span",{style:h("#e21d1d")}),"Incomplete"]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,s.jsx)("span",{style:h("#f6c927")}),"Moderate"]})]}),(0,s.jsx)("div",{style:{marginTop:40},children:(0,s.jsx)(b,{highcharts:i(),options:{chart:{type:"pie",backgroundColor:"transparent",height:340},title:{text:""},legend:{enabled:!1},plotOptions:{pie:{borderWidth:7,borderColor:"#fff",shadow:{color:"rgba(0,0,0,0.28)",offsetY:12,width:22},dataLabels:{enabled:!1},startAngle:-30}},series:[{type:"pie",data:t}],credits:{enabled:!1}}})})]}),(0,s.jsxs)("div",{className:"bg-white shadow-xl rounded-2xl p-6",style:{border:"2px solid rgba(0,0,0,0.08)"},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsx)("h2",{style:{fontSize:20,fontWeight:700,color:"#222"},children:"Matches Per Month"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:15,fontSize:16,fontWeight:600},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,s.jsx)("span",{style:h("#d2a103")}),"Total no. of Users"]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,s.jsx)("span",{style:h("#e22c2c")}),"No. Of Matches"]})]})]}),(0,s.jsx)("div",{style:{marginTop:30},children:(0,s.jsx)(b,{highcharts:i(),options:d})})]})]})})}var j=a(8e3),w=a(7965),v=a(4758),N=a(2333),k=a(4354),S=a(8072),C=a(6766),E=a(2287);function F(){let[e,t]=(0,l.useState)([]),[a,r]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(g.H,"/admin/reports-this-week")),a=await e.json();a.success&&t(a.data)}finally{r(!1)}})()},[]),(0,s.jsx)("div",{className:"p-4 sm:p-6 max-w-6xl mx-auto",children:(0,s.jsxs)("div",{className:"rounded-[24px] p-8",style:{background:"#FFFFFF",border:"1px solid #D6D6D6",boxShadow:"0px 6px 18px rgba(0,0,0,0.12)"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h3",{className:"text-[26px] font-semibold text-gray-900",children:"Reports This Week"}),(0,s.jsxs)("div",{className:"flex items-center gap-7 text-[16px] font-medium text-gray-800",children:[(0,s.jsx)(A,{label:"Fake",color:"#FF7C7C"}),(0,s.jsx)(A,{label:"Inappropriate profile",color:"#FFC400"}),(0,s.jsx)(A,{label:"Spam",color:"#76D64C"}),(0,s.jsx)(A,{label:"Harassment",color:"#47D0FF"})]})]}),a?(0,s.jsx)("p",{className:"text-gray-600 text-lg",children:"Loading..."}):(0,s.jsx)("div",{className:"w-full h-[420px]",children:(0,s.jsx)(j.u,{width:"100%",height:"100%",children:(0,s.jsxs)(w.E,{data:e,margin:{top:10,right:20,left:0,bottom:25},barCategoryGap:38,children:[(0,s.jsx)(v.d,{stroke:"#D8D8D8",strokeWidth:1,horizontal:!0,vertical:!1}),(0,s.jsx)(N.W,{dataKey:"day",tick:{fill:"#4B4B4B",fontSize:16}}),(0,s.jsx)(k.h,{domain:[0,70],ticks:[0,10,20,30,40,50,60,70],tickFormatter:e=>"".concat(e," %"),tick:{fill:"#4B4B4B",fontSize:16}}),(0,s.jsx)(S.m,{formatter:e=>"".concat(e,"%"),contentStyle:{borderRadius:"12px",border:"1px solid #ccc",background:"#ffffff",fontSize:"14px",padding:"12px",boxShadow:"0 2px 14px rgba(0,0,0,0.15)"}}),(0,s.jsx)(C.y,{dataKey:"fake",stackId:"a",fill:"#FF7C7C",radius:[6,6,0,0],children:(0,s.jsx)(E.Ze,{dataKey:"fake",formatter:e=>"".concat(e,"%"),fill:"#000",position:"top"})}),(0,s.jsx)(C.y,{dataKey:"inappropriate",stackId:"a",fill:"#FFC400"}),(0,s.jsx)(C.y,{dataKey:"spam",stackId:"a",fill:"#76D64C"}),(0,s.jsx)(C.y,{dataKey:"harassment",stackId:"a",fill:"#47D0FF"})]})})})]})})}function A(e){let{label:t,color:a}=e;return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{style:{width:"16px",height:"16px",borderRadius:"6px",background:a,border:"2px solid ".concat(a)}}),t]})}let T=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m,{}),(0,s.jsx)(x,{}),(0,s.jsx)(y,{}),(0,s.jsx)(F,{})]})},7814:(e,t,a)=>{"use strict";a.d(t,{G1:()=>i,Ol:()=>n,cH:()=>r});var s=a(2692);let l=null;function r(e){return l&&l.connected||((l=(0,s.io)("https://matrimonial-backend-7ahc.onrender.com",{transports:["websocket"],secure:!0,reconnection:!0,reconnectionAttempts:10,path:"/socket.io",query:{adminId:e}})).on("connect",()=>{console.log("\uD83D\uDD35 SOCKET CONNECTED:",l.id)}),l.on("disconnect",()=>{console.log("\uD83D\uDD34 SOCKET DISCONNECTED")})),l}function i(){l&&(l.disconnect(),console.log("\uD83D\uDD34 SOCKET MANUALLY DISCONNECTED"))}function n(){return l}}},e=>{e.O(0,[853,692,220,725,452,636,593,792],()=>e(e.s=483)),_N_E=e.O()}]);